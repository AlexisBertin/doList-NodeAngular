// Server.js
// Setup
var express=require("express"),app=express(),mongoose=require("mongoose"),morgan=require("morgan"),bodyParser=require("body-parser"),methodOverride=require("method-override");mongoose.connect("mongodb://node:node@mongo.onmodulus.net:27017/uw03mypu");app.use(express.static(__dirname+"/public"));app.use(morgan("dev"));app.use(bodyParser.urlencoded({extended:"true"}));app.use(bodyParser.json());app.use(bodyParser.json({type:"application/vnd.api+json"}));app.use(methodOverride());var Todo=mongoose.model("Todo",{text:String});app.get("/api/todos",function(e,t){Todo.find(function(e,n){e&&t.send(e);t.json(n)})});app.post("/api/todos",function(e,t){Todo.create({text:e.body.text,done:!1},function(e,n){e&&t.send(e);Todo.find(function(e,n){e&&t.send(e);t.json(n)})})});app.delete("/api/todos/:todo_id",function(e,t){Todo.remove({_id:e.params.todo_id},function(e,n){e&&t.send(e);Todo.find(function(e,n){e&&t.send(e);t.json(n)})})});app.get("*",function(e,t){t.sendfile("./public/index.html")});app.listen(8080);console.log("- App listening on port 8080 -");